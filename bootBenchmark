#!/bin/bash

# boot ok timestamp
echo "Boot Benchmark" > /dev/kmsg

# create the data file
cat /proc/version > /home/$(uname -r).log

# get cpu usage since boot
echo "----------------------------------------------------------------------------------------" >> /home/$(uname -r).log
echo "ðŸ”¥ CPU USAGE" >> /home/$(uname -r).log
awk '/cpu /{print 100*($2+$4)/($2+$4+$5)}' /proc/stat >> /home/$(uname -r).log

# get memory usage
echo "----------------------------------------------------------------------------------------" >> /home/$(uname -r).log
echo "ðŸ’½ MEMORY USAGE" >> /home/$(uname -r).log
free >> /home/$(uname -r).log
free -h >> /home/$(uname -r).log

# get the timestamp
echo "----------------------------------------------------------------------------------------" >> /home/$(uname -r).log
echo "ðŸ‘¢ BOOT TIME" >> /home/$(uname -r).log
dmesg | grep 'Boot Benchmark' >> /home/$(uname -r).log

# get the dmesg logs
echo "----------------------------------------------------------------------------------------" >> /home/$(uname -r).log
echo "ðŸ‘¢ðŸ‘¢ KERNEL LOG" >> /home/$(uname -r).log

EMERG=$(dmesg -r | grep -c '<0>')
ALERT=$(dmesg -r | grep -c '<1>')
CRIT=$(dmesg -r | grep -c '<2>')
ERR=$(dmesg -r | grep -c '<3>')
WARN=$(dmesg -r | grep -c '<4>')
NOTICE=$(dmesg -r | grep -c '<5>')
INFO=$(dmesg -r | grep -c '<6>')
BUG=$(dmesg -r | grep -c '<7>')

echo "ðŸ”¥ EMERGENCY x$EMERG" >> /home/$(uname -r).log
echo "ðŸš¨ ALERT     x$ALERT" >> /home/$(uname -r).log
echo "ðŸ’€ CRITICAL  x$CRIT" >> /home/$(uname -r).log
echo "âŒ ERROR     x$ERR" >> /home/$(uname -r).log
echo "âš ï¸ WARN      x$WARN" >> /home/$(uname -r).log
echo "ðŸ”” NOTICE    x$NOTICE" >> /home/$(uname -r).log
echo "â„¹ï¸ INFO      x$INFO" >> /home/$(uname -r).log
echo "ðŸª² BUG       x$BUG" >> /home/$(uname -r).log
